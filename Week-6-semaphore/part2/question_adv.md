advanced part of prev question
